<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Export AI Assistant - Demo Access</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #f3f4f6;
    color: #1f2937;
    margin: 0; padding: 0;
    display: flex; flex-direction: column; align-items: center; min-height: 100vh;
  }
  header {
    background-color: #2563eb;
    color: white;
    width: 100%;
    padding: 1.5rem 0;
    text-align: center;
    font-size: 1.8rem;
  }
  main {
    max-width: 540px;
    margin: 2rem auto;
    background: white;
    padding: 2rem 2.5rem;
    border-radius: 8px;
    box-shadow: 0 6px 15px rgb(0 0 0 / 0.1);
    width: 90%;
  }
  .instructions {
    background: #eff6ff;
    border: 1px solid #2563eb;
    color: #2563eb;
    border-radius: 8px;
    padding: 1rem;
    font-size: 1.08rem;
    margin-bottom: 1.5rem;
    text-align: center;
  }
  .welcome-message {
    background: #f1f5fb;
    border: 1px solid #2563eb;
    border-radius: 6px;
    color: #111827;
    padding: 1rem;
    font-size: 1.12rem;
    text-align: center;
    margin-bottom: 1rem;
  }
  label {
    display: block;
    margin-bottom: 0.6rem;
    font-weight: 600;
  }
  input[type="text"] {
    width: 100%;
    padding: 0.6rem 0.8rem;
    font-size: 1rem;
    border: 2px solid #cbd5e1;
    border-radius: 5px;
    margin-bottom: 1.2rem;
    box-sizing: border-box;
  }
  button {
    background-color: #2563eb;
    border: none;
    color: white;
    padding: 0.8rem 2rem;
    font-size: 1.1rem;
    font-weight: 600;
    cursor: pointer;
    border-radius: 6px;
    margin: 0.5rem 0.5rem 0.5rem 0;
    transition: background-color 0.25s ease;
  }
  button:hover {
    background-color: #1d4ed8;
  }
  .message {
    margin-top: 1rem;
    font-size: 0.95rem;
    color: #dc2626;
    text-align: center;
  }
  .status-message {
    background: #f3f4f6;
    border: 1px solid #2563eb;
    border-radius: 8px;
    padding: 1rem;
    color: #1e293b;
    margin-bottom: 1.3rem;
    font-size: 1.1rem;
    text-align: center;
  }
  .agent-container {
    margin-top: 2rem;
    display: none;
  }
  .session-controls {
    margin: 1rem 0 2rem 0;
    text-align: center;
  }
  .hide {
    display: none!important;
  }
  footer {
    margin-top: auto;
    padding: 1rem;
    font-size: 0.85rem;
    color: #6b7280;
    text-align: center;
  }
</style>
</head>
<body>

<header>Export AI Assistant - Demo Access</header>

<main>

  <div class="instructions">
    Welcome! To begin, enter your demo code.<br>
    You will receive personalized access, and only use time/questions when actively interacting.<br>
    You can pause or exit anytime.
  </div>

  <div id="code-entry-area">
    <label for="accessCode">Enter Your Demo Access Code:</label>
    <input type="text" id="accessCode" placeholder="Demo Code Here" />
    <button id="validateBtn">Validate Code</button>
    <div class="message" id="message"></div>
  </div>

  <div class="agent-container" id="agentArea">
    <div class="welcome-message" id="welcomeMessage"></div>
    <div class="status-message" id="statusMessage"></div>
    <div class="session-controls" id="sessionControls">
      <button id="startBtn">Start Demo Session</button>
      <button id="pauseBtn" class="hide">Pause Session</button>
      <button id="resumeBtn" class="hide">Resume Session</button>
      <button id="stopBtn">Exit Session</button>
    </div>
    <button id="sendMsgBtn" class="hide">Send Message to Agent</button>
    <!-- Replace the above button with your agent widget and connect events to sendMsg -->
  </div>
  <div id="exitMessage" class="hide message"></div>
</main>

<footer>
  Â© 2025 Canadian Export AI Assistant | SinghLabs
</footer>

<script>
const demoCodes = {
  "ADAM2025": { name: "Adam", interactions: 12, minutes: 10 },
  "ABDULVIP": { name: "Abdul", interactions: 8, minutes: 10 },
  "ANDYTRIAL": { name: "Andy", interactions: 10, minutes: 10 },
  "CEDGROWTH": { name: "Ced", interactions: 7, minutes: 10 }
};

const contactEmail = "ask@rajbir.guru";
let activeCode = '';
let userName = '';
let interactionsLeft = 0;
let minutesLeft = 0;
let secondsLeft = 0;
let timerInterval = null;
let isSessionActive = false;
let interactionsUsed = 0;
let paused = false;

const accessCodeInput = document.getElementById("accessCode");
const validateBtn = document.getElementById("validateBtn");
const messageDiv = document.getElementById("message");
const agentArea = document.getElementById("agentArea");
const codeEntryArea = document.getElementById("code-entry-area");
const welcomeMessage = document.getElementById("welcomeMessage");
const statusMessage = document.getElementById("statusMessage");
const sessionControls = document.getElementById("sessionControls");
const startBtn = document.getElementById("startBtn");
const pauseBtn = document.getElementById("pauseBtn");
const resumeBtn = document.getElementById("resumeBtn");
const stopBtn = document.getElementById("stopBtn");
const sendMsgBtn = document.getElementById("sendMsgBtn");
const exitMessage = document.getElementById("exitMessage");

function loadUsage(code) {
  const use = JSON.parse(localStorage.getItem("agent_usage_" + code));
  if (use && typeof use.interactions === 'number' && typeof use.minutes === 'number' && use.name) {
    interactionsLeft = use.interactions;
    minutesLeft = use.minutes;
    interactionsUsed = use.totalUsed || 0;
    userName = use.name;
  } else {
    interactionsLeft = demoCodes[code].interactions;
    minutesLeft = demoCodes[code].minutes;
    interactionsUsed = 0;
    userName = demoCodes[code].name;
  }
  secondsLeft = 0;
}

function saveUsage(code) {
  localStorage.setItem(
    "agent_usage_" + code,
    JSON.stringify({
      interactions: interactionsLeft,
      minutes: minutesLeft,
      totalUsed: interactionsUsed,
      name: userName
    })
  );
}

function updateStatusMessage() {
  let min = minutesLeft > 0 ? minutesLeft : 0;
  let sec = secondsLeft > 0 ? secondsLeft : 0;
  if (sec < 10) sec = '0' + sec;
  let timeText = `Time remaining: <strong>${min}:${sec}</strong> minutes`;
  let questionsText = `Questions remaining: <strong>${interactionsLeft}</strong>`;
  statusMessage.innerHTML =
    `Demo access granted!<br>${timeText} &nbsp;|&nbsp; ${questionsText}`;
}

function updateWelcomeMessage() {
  welcomeMessage.innerHTML =
    `Welcome <strong>${userName}</strong>, here is a demo session created for you as a courtesy by SinghLabs.`;
}

function showExitMessage(custom) {
  exitMessage.classList.remove("hide");
  exitMessage.innerHTML =
    custom ||
    `Thank you for exploring Export AI Assistant.<br>We look forward to welcoming you back again.<br>
     If your demo limit is reached, please contact SinghLabs at <a href="mailto:${contactEmail}">${contactEmail}</a>.`;
}

function startSession() {
  if (!isSessionActive && minutesLeft > 0 && interactionsLeft > 0) {
    isSessionActive = true;
    paused = false;
    startBtn.classList.add("hide");
    pauseBtn.classList.remove("hide");
    resumeBtn.classList.add("hide");
    sendMsgBtn.classList.remove("hide");
    exitMessage.classList.add("hide");
    timerInterval = setInterval(() => {
      if (!paused) {
        if (secondsLeft === 0) {
          if (minutesLeft === 0) {
            stopSession(true);
            showExitMessage(
              `Your demo time limit has ended. Please contact SinghLabs at <a href="mailto:${contactEmail}">${contactEmail}</a> to request more access.`
            );
            return;
          } else {
            minutesLeft -= 1;
            secondsLeft = 59;
          }
        } else {
          secondsLeft -= 1;
        }
        updateStatusMessage();
        saveUsage(activeCode);
      }
    }, 1000);
  }
}

function pauseSession() {
  paused = true;
  pauseBtn.classList.add("hide");
  resumeBtn.classList.remove("hide");
}

function resumeSession() {
  paused = false;
  pauseBtn.classList.remove("hide");
  resumeBtn.classList.add("hide");
}

function stopSession(exit = false) {
  isSessionActive = false;
  startBtn.classList.remove("hide");
  pauseBtn.classList.add("hide");
  resumeBtn.classList.add("hide");
  sendMsgBtn.classList.add("hide");
  if (timerInterval) {
    clearInterval(timerInterval);
    timerInterval = null;
  }
  saveUsage(activeCode);
  if (exit) {
    agentArea.style.display = "none";
    codeEntryArea.style.display = "block";
    showExitMessage();
  }
}

function sendMsg() {
  if (interactionsLeft > 0 && isSessionActive && !paused) {
    interactionsLeft -= 1;
    interactionsUsed += 1;
    updateStatusMessage();
    saveUsage(activeCode);
    if (interactionsLeft === 0) {
      stopSession(true);
      showExitMessage(
        `Your demo questions limit is reached. Please contact SinghLabs at <a href="mailto:${contactEmail}">${contactEmail}</a> for more access.`
      );
    }
  }
}

validateBtn.addEventListener("click", () => {
  const code = accessCodeInput.value.trim().toUpperCase();
  exitMessage.classList.add("hide");
  if (!code) {
    messageDiv.textContent = "Please enter a demo access code.";
    messageDiv.style.color = "#dc2626";
    return;
  }
  if (demoCodes[code]) {
    activeCode = code;
    loadUsage(code);
    if (interactionsLeft === 0 || minutesLeft === 0) {
      codeEntryArea.style.display = "none";
      agentArea.style.display = "none";
      showExitMessage(
        `Your demo limit is reached. Please contact SinghLabs at <a href="mailto:${contactEmail}">${contactEmail}</a> for more access.`
      );
      return;
    }
    messageDiv.textContent = "";
    codeEntryArea.style.display = "none";
    agentArea.style.display = "block";
    updateWelcomeMessage();
    updateStatusMessage();
    stopSession(); // start with idle state
  } else {
    messageDiv.textContent = "Invalid demo code. Please try again or contact support.";
    messageDiv.style.color = "#dc2626";
  }
});

startBtn.addEventListener("click", startSession);
pauseBtn.addEventListener("click", pauseSession);
resumeBtn.addEventListener("click", resumeSession);
stopBtn.addEventListener("click", () => stopSession(true));
sendMsgBtn.addEventListener("click", sendMsg);

window.addEventListener("DOMContentLoaded", () => {
  for (let code in demoCodes) {
    if (localStorage.getItem("agent_usage_" + code)) {
      activeCode = code;
      loadUsage(code);
      if (interactionsLeft > 0 && minutesLeft > 0) {
        codeEntryArea.style.display = "none";
        agentArea.style.display = "block";
        updateWelcomeMessage();
        updateStatusMessage();
        stopSession(); // Show idle state
      } else {
        codeEntryArea.style.display = "none";
        agentArea.style.display = "none";
        showExitMessage(
          `Your demo limit is reached. Please contact SinghLabs at <a href="mailto:${contactEmail}">${contactEmail}</a> for more access.`
        );
      }
      break;
    }
  }
});
</script>

</body>
</html>
